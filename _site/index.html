<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Welcome to Yongho's Blog &#8211; Yongho's Blog</title>
<meta name="description" content="">
<meta name="keywords" content="Jekyll, theme, themes, responsive, blog, modern">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@yongho42">
<meta name="twitter:creator" content="@yongho42">

<!-- Open Graph -->
<meta property="og:locale" content="ko_KR">
<meta property="og:type" content="article">
<meta property="og:title" content="Welcome to Yongho's Blog">
<meta property="og:description" content="">
<meta property="og:url" content="http://yonghochoi.github.io//">
<meta property="og:site_name" content="Yongho's Blog">
<meta property="og:image" content="http://yonghochoi.github.io//images/">





<link rel="canonical" href="http://yonghochoi.github.io//">
<link href="http://yonghochoi.github.io//feed.xml" type="application/atom+xml" rel="alternate" title="Yongho's Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>

<!-- For all browsers -->
<link rel="stylesheet" href="http://yonghochoi.github.io//assets/css/main.css">
<link rel="stylesheet" href="http://yonghochoi.github.io//assets/css/jquery.mmenu.all.css">
<link rel="stylesheet" href="http://yonghochoi.github.io//assets/css/jquery.floating-social-share.min.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script type="text/javascript" src="http://yonghochoi.github.io//assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://yonghochoi.github.io//favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://yonghochoi.github.io//favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://yonghochoi.github.io//images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://yonghochoi.github.io//images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://yonghochoi.github.io//images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://yonghochoi.github.io//images/apple-touch-icon-144x144-precomposed.png">




</head>

<body id="post-index">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->



<div class="header-menu header-menu-top">
    <ul class="header-item-container">
      <li class="header-item-title header-toggle "><a href="#menu"><h2><i class="fa fa-bars"></i></h2></a></li>
      <li class="header-item-title">
        <a href="http://yonghochoi.github.io//">
          
          <a href="http://yonghochoi.github.io//" class="title"> Yongho's Blog</a>
        </a>
      </li>
      
        
        

        
          <li class="header-item "><a href="http://yonghochoi.github.io//categories"><h3>Categories</h3></a>
            <ul class="header-submenu">
              
            </ul>
          </li>
        
      
        
        

        
            
                <li class="header-item "><a href="http://yonghochoi.github.io//tags"><h3>Tags</h3></a></li>
            
        
      
        
        

        
            
                <li class="header-item "><a href="https://github.com/YonghoChoi" target="_blank"><h3>Github</h3></a></li>
            
        
      
        
        

        
            
                <li class="header-item "><a href="http://yonghochoi.github.io//"><h3>Home</h3></a></li>
            
        
      
      <li class="header-item"><a href="http://yonghochoi.github.io//search"><h3><i class="fa fa-search"></i></h3></a></li>
    </ul>
  </div>
<div class="entry-header">
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>Welcome to Yongho's Blog</h1>
      
        <h2><span class="entry-date"><time>&nbsp;</time></span></h2>
      

      
          <p class="entry-reading-time">
            &nbsp;
          </p><!-- /.entry-reading-time -->
      
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->


<nav id="menu" style="display: none">
  <ul>
    
      
        <li><a href="http://yonghochoi.github.io//"><h3>Home</h3></a></li>
      
    
      
        <li><a href="http://yonghochoi.github.io/https://github.com/YonghoChoi"><h3>Github</h3></a></li>
      
    
      
        <li><a href="http://yonghochoi.github.io//tags"><h3>Tags</h3></a></li>
      
    
      
        <li><a href="http://yonghochoi.github.io//categories"><h3>Categories</h3></a>
          <ul>
            
          </ul>
        </li>
      
    
  </ul>
</nav>


  <a href="https://twitter.com/yongho42" class="btn btn-info button-twitter" data-show-count="false" data-size="large"><i class="fa fa-twitter"></i> <span> | Follow @yongho42</span></a>



<div id="main" role="main">
  
<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2016-07-18T20:51:00+09:00"><a href="http://yonghochoi.github.io//refactoring-to-patterns/">July 18, 2016</a></time></span><span class="author vcard"><span class="fn"><a href="http://yonghochoi.github.io//about/" title="About YonghoChoi">YonghoChoi</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://yonghochoi.github.io//refactoring-to-patterns/" rel="bookmark" title="패턴을 활용한 리팩터링" itemprop="url">패턴을 활용한 리팩터링</a></h1>
    
  </header>
  <div class="entry-content">
    
      <ul>
  <li><a href="http://yonghochoi.github.io//composite-1/">Replace One/Many Distinctions with Composite</a></li>
</ul>


    
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2016-07-18T20:51:00+09:00"><a href="http://yonghochoi.github.io//composite-1/">July 18, 2016</a></time></span><span class="author vcard"><span class="fn"><a href="http://yonghochoi.github.io//about/" title="About YonghoChoi">YonghoChoi</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~6 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://yonghochoi.github.io//composite-1/" rel="bookmark" title="Replace One/Many Distinctions with Composite" itemprop="url">Replace One/Many Distinctions with Composite</a></h1>
    
  </header>
  <div class="entry-content">
    
      <div class="highlighter-rouge"><pre class="highlight"><code>어떤 클래스에서 주어진 객체를 처리할 때,
그 객체의 개수에 따라 서로 다른 로직을 사용하고 있다면,
컴포짓을 사용해 객체의 개수에 상관없이 한 로직으로 처리할 수 있도록 만든다.
</code></pre>
</div>

<p><img src="https://github.com/YonghoChoi/YonghoChoi.github.io/tree/master/images/refactoring-to-patterns/Composite1.GIF" alt="" /></p>

<ul>
  <li>어떤 클래스 : ProductRepository</li>
  <li>주어진 객체 : Spec</li>
  <li>객체의 개수에 따라 : 단수 / 복수</li>
  <li>서로 다른 로직 : selectBy(Spec:Spec) / selectBy (Spec:List)</li>
</ul>

<h2 id="section">동기</h2>

<ul>
  <li>코드가 중복된다.
    <ul>
      <li>처리할 객체가 하나 인 경우와 여러 개인 경우의 처리 로직은 기본 적으로 동일한 경우가 많음.</li>
    </ul>
  </li>
  <li>클라이언트 코드가 복잡해진다.
    <ul>
      <li>처리할 객체 마다 시그니처가 다른 메서드들이 존재하게 됨. 이에 따라 클라이언트도 호출을 다르게 해야 하므로 복잡해짐.</li>
      <li>클라이언트에서는 객체의 수에 상관 없이 동일한 방법으로 처리하는 것을 선호.</li>
    </ul>
  </li>
  <li>처리 결과를 취합하기 위해서 추가적인 처리가 필요하다.
    <ul>
      <li>조건이 여러개인 경우 조건에 따른 결과를 합쳐야 한다.</li>
      <li>아래의 코드는 조건이 여러개 인 경우의 처리 예시 이다. (빨간색이면서 가격이 5달러 이하인 상품 조회)</li>
    </ul>
  </li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">List</span> <span class="n">redProductsUnderFiveDollars</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
<span class="n">redProductsUnderFiveDollars</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">ColorSpec</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">red</span><span class="o">));</span>
<span class="n">redProductsUnderFiveDollars</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">BelowPriceSpec</span><span class="o">(</span><span class="mf">5.00</span><span class="o">));</span>

<span class="n">List</span> <span class="n">foundRedProductsUnderFiveDollars</span> <span class="o">=</span>
	<span class="n">productRepository</span><span class="o">.</span><span class="na">selectBy</span><span class="o">(</span><span class="n">redProductsUnderFiveDollars</span><span class="o">);</span></code></pre></figure>

<ul>
  <li>여기서 추가로 파란색이면서 가격이 10달러 이하인 상품을 찾으려면 두 조건에 대해 각각 검색한 후 그 결과를 합쳐야 한다.</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">List</span> <span class="n">foundRedProductsUnderFiveDollars</span> <span class="o">=</span>
	<span class="n">productRepository</span><span class="o">.</span><span class="na">selectBy</span><span class="o">(</span><span class="n">redProductsUnderFiveDollars</span><span class="o">);</span>

<span class="n">List</span> <span class="n">foundBlueProductsUnderFiveDollars</span> <span class="o">=</span>
	<span class="n">productRepository</span><span class="o">.</span><span class="na">selectBy</span><span class="o">(</span><span class="n">blueProductsUnderFiveDollars</span><span class="o">);</span>

<span class="n">List</span> <span class="n">foundProducts</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
<span class="n">foundProducts</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">foundRedProductsUnderFiveDollars</span><span class="o">);</span>
<span class="n">foundProducts</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">foundBludProductsUnderFiveDollars</span><span class="o">);</span></code></pre></figure>

<ul>
  <li>Composite 패턴을 사용하는 경우의 이점.
    <ul>
      <li>코드 중복 제거</li>
      <li>클라이언트 코드가 간결해짐.</li>
      <li>클라이언트에서는 조건에 따른 결과 합산과 같은 성가신 작업을 할 필요 없음.</li>
    </ul>
  </li>
  <li>주의 사항
    <ul>
      <li>클라이언트의 입장이 별로 중요하지 않고, 코드 중복을 최소화 할 수 있다면 굳이 Composite 패턴을 사용할 필요 없다.</li>
      <li>Composite 패턴의 단점 가운데 하나는 타입 안전성 문제
        <ul>
          <li>클라이언트가 객체를 추가하려 할 때마다 객체를 확인하는 절차가 포함되어야 한다.</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><img src="https://github.com/YonghoChoi/YonghoChoi.github.io/tree/master/images/refactoring-to-patterns/Composite2.GIF" alt="" /></p>

<h2 id="section-1">장점과 단점</h2>

<div class="highlighter-rouge"><pre class="highlight"><code>+ 중복 코드 제거
+ 객체 하나를 처리하는 방법과 여러개를 처리하는 방법이 하나로 통일
+ 여러 개의 객체를 처리하기 위해 필요한 추가적인 기능 부여 가능 (ex - OR 조건 표현)
- 타입 안전성을 위해 런타임 타입 검사가 필요할 수 있다.
</code></pre>
</div>

<h2 id="section-2">절차</h2>

<ul>
  <li>용어 정의
    <ul>
      <li>단수 객체 메서드 : 하나의 객체를 처리하는 메서드</li>
      <li>복수 객체 메서드 : 여러 개의 객체를 처리하는 메서드</li>
    </ul>
  </li>
</ul>

<ol>
  <li>복수 객체 메서드는 컬렉션을 파라미터로 받음.</li>
  <li>복수 객체 메서드 내부에서 컬렉션을 다루는 코드에 Extract Method 리팩터링 적용.</li>
  <li>단수/복수 메서드 간의 차이가 존재한다면 리팩터링을 통해 제거.</li>
  <li>컴포짓 객체를 파라미터로 하여 단수 객체 메서드를 호출하는 한줄의 코드만을 포함하도록 복수 객체 메서드를 수정.</li>
  <li>복수 객체 메서드를 Inline Method 리펙터링을 통해 인라인화.</li>
  <li>컴포짓 클래스에 타입 안전성 체크를 위해 Encapsulate Collection 리팩터링을 적용.</li>
</ol>

<h2 id="section-3">예제</h2>

<ul>
  <li>내용 요약 : ProductRepository 객체로부터 원하는 Product 객체의 목록을 얻기 위해 Spec 객체를 사용하는 코드.
    <ul>
      <li>ProductRepository : Product의 리스트를 가짐.</li>
      <li>Product : 상품 객체</li>
      <li>Spec : 상품 검색을 위한 조건을 명시.</li>
    </ul>
  </li>
  <li>예제는 TestCase를 사용하여 진행.</li>
</ul>

<p><em>원본 코드 테스트 및 리팩토링</em></p>

<p>먼저 테스트를 위한 임의의 상품 정보를 셋팅한다.</p>

<ul>
  <li>ProductRepository에 Product 추가</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductRepositoryTest</span> <span class="kd">extends</span> <span class="n">TestCase</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="n">ProductRepository</span> <span class="n">repository</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">Product</span> <span class="n">fireTruck</span> <span class="o">=</span>
    	<span class="k">new</span> <span class="n">Product</span><span class="o">(</span><span class="s">"f1234"</span><span class="o">,</span> <span class="s">"Fire Truck"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">red</span><span class="o">,</span> <span class="mf">8.95f</span><span class="o">,</span> <span class="n">ProductSize</span><span class="o">.</span><span class="na">MEDIUM</span><span class="o">);</span>

    <span class="kd">private</span> <span class="n">Product</span> <span class="n">barbieClassic</span> <span class="o">=</span>
    	<span class="k">new</span> <span class="n">Product</span><span class="o">(</span><span class="s">"b7654"</span><span class="o">,</span> <span class="s">"Barbie Classic"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">yellow</span><span class="o">,</span> <span class="mf">15.95f</span><span class="o">,</span> <span class="n">ProductSize</span><span class="o">.</span><span class="na">SMALL</span><span class="o">);</span>

    <span class="kd">private</span> <span class="n">Product</span> <span class="n">frisbee</span> <span class="o">=</span>
    	<span class="k">new</span> <span class="n">Product</span><span class="o">(</span><span class="s">"f4321"</span><span class="o">,</span> <span class="s">"Frisbee"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">pink</span><span class="o">,</span> <span class="mf">9.99f</span><span class="o">,</span> <span class="n">ProductSize</span><span class="o">.</span><span class="na">LARGE</span><span class="o">);</span>

    <span class="kd">private</span> <span class="n">Product</span> <span class="n">baseball</span> <span class="o">=</span>
    	<span class="k">new</span> <span class="n">Product</span><span class="o">(</span><span class="s">"b2343"</span><span class="o">,</span> <span class="s">"Baseball"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">white</span><span class="o">,</span> <span class="mf">8.95f</span><span class="o">,</span> <span class="n">ProductSize</span><span class="o">.</span><span class="na">NOT_APPLICABLE</span><span class="o">);</span>

    <span class="kd">private</span> <span class="n">Product</span> <span class="n">toyConvertible</span> <span class="o">=</span>
    	<span class="k">new</span> <span class="n">Product</span><span class="o">(</span><span class="s">"p1112"</span><span class="o">,</span> <span class="s">"Toy Porsche Convertible"</span><span class="o">,</span> <span class="n">Color</span><span class="o">.</span><span class="na">red</span><span class="o">,</span> <span class="mf">230.00f</span><span class="o">,</span> <span class="n">ProductSize</span><span class="o">.</span><span class="na">NOT_APPLICABLE</span><span class="o">);</span>

    <span class="kd">protected</span> <span class="kt">void</span> <span class="n">setUp</span><span class="o">()</span> <span class="o">{</span>
    	<span class="n">repository</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ProductRepository</span><span class="o">();</span>
        <span class="n">repository</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">fireTruck</span><span class="o">);</span>
        <span class="n">repository</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">barbieClassic</span><span class="o">);</span>
        <span class="n">repository</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">frisbee</span><span class="o">);</span>
        <span class="n">repository</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">baseball</span><span class="o">);</span>
        <span class="n">repository</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">toyConvertible</span><span class="o">);</span>
    <span class="o">}</span>
	<span class="o">}</span></code></pre></figure>

<p>리팩터링 전 코드로 특정 색상의 Product를 찾는 테스트를 수행한다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductRepositoryTest</span> <span class="kd">extends</span> <span class="n">TestCase</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="n">testFindByColor</span><span class="o">()</span> <span class="o">{</span>
    	<span class="n">List</span> <span class="n">foundProducts</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="na">selectBy</span><span class="o">(</span><span class="k">new</span> <span class="n">ColorSpec</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">red</span><span class="o">));</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"found 2 red products"</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="n">foundProducts</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
        <span class="n">assertTrue</span><span class="o">(</span><span class="s">"found fireTruck"</span><span class="o">,</span> <span class="n">foundProducts</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">fireTruck</span><span class="o">));</span>
        <span class="n">assertTrue</span><span class="o">(</span><span class="s">"found Toy Porsche Convertible"</span><span class="o">,</span> <span class="n">foundProducts</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">toyConvertible</span><span class="o">));</span>
    <span class="o">}</span>
	<span class="o">}</span></code></pre></figure>

<p>selectBy의 구현 내용</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductRepository</span><span class="o">{</span>
	<span class="kd">private</span> <span class="n">List</span> <span class="n">products</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>

    <span class="kd">public</span> <span class="n">Iterator</span> <span class="n">iterator</span><span class="o">()</span> <span class="o">{</span>
    	<span class="k">return</span> <span class="n">products</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">List</span> <span class="n">selectBy</span><span class="o">(</span><span class="n">Spec</span> <span class="n">spec</span><span class="o">)</span> <span class="o">{</span>
    	<span class="n">List</span> <span class="n">foundProducts</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
        <span class="n">Iterator</span> <span class="n">products</span> <span class="o">=</span> <span class="n">iterator</span><span class="o">();</span>
        <span class="k">while</span><span class="o">(</span><span class="n">products</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
        	<span class="n">Product</span> <span class="n">product</span> <span class="o">=</span> <span class="o">(</span><span class="n">Product</span><span class="o">)</span><span class="n">products</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="k">if</span><span class="o">(</span><span class="n">spec</span><span class="o">.</span><span class="na">isSatisfiedBy</span><span class="o">(</span><span class="n">product</span><span class="o">))</span>
            	<span class="n">foundProducts</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">foundProducts</span><span class="o">;</span>
    <span class="o">}</span>
	<span class="o">}</span></code></pre></figure>

<p>색상 뿐만이 아닌 복수의 조건을 처리하는 경우 (List 객체 전달)</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductRepositoryTest</span> <span class="kd">extends</span> <span class="n">TestCase</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="n">testFindByColorSizeAndBelowPrice</span><span class="o">()</span> <span class="o">{</span>
    	<span class="n">List</span> <span class="n">specs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
        <span class="n">specs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">ColorSpec</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">red</span><span class="o">));</span>
        <span class="n">specs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">SizeSpec</span><span class="o">(</span><span class="n">ProductSize</span><span class="o">.</span><span class="na">SMALL</span><span class="o">));</span>
        <span class="n">specs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">BelowPriceSpec</span><span class="o">(</span><span class="mf">10.00</span><span class="o">));</span>
    	<span class="n">List</span> <span class="n">foundProducts</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="na">selectBy</span><span class="o">(</span><span class="n">specs</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"small red products below $10.00"</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">foundProducts</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
    <span class="o">}</span>
	<span class="o">}</span></code></pre></figure>

<p>List를 사용하는 selectBy의 구현 내용.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductRepository</span><span class="o">{</span>
	<span class="kd">public</span> <span class="n">List</span> <span class="n">selectBy</span><span class="o">(</span><span class="n">List</span> <span class="n">specs</span><span class="o">)</span> <span class="o">{</span>
    	<span class="n">List</span> <span class="n">foundProducts</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
        <span class="n">Iterator</span> <span class="n">products</span> <span class="o">=</span> <span class="n">iterator</span><span class="o">();</span>
        <span class="k">while</span><span class="o">(</span><span class="n">products</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
        	<span class="n">Product</span> <span class="n">product</span> <span class="o">=</span> <span class="o">(</span><span class="n">Product</span><span class="o">)</span><span class="n">products</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="n">Iterator</span> <span class="n">specifications</span> <span class="o">=</span> <span class="n">specs</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
            <span class="kt">boolean</span> <span class="n">satisfiesAllSpecs</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="k">while</span><span class="o">(</span><span class="n">specifications</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            	<span class="n">Spec</span> <span class="n">productSpec</span> <span class="o">=</span> <span class="o">((</span><span class="n">Spec</span><span class="o">)</span><span class="n">specifications</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
                <span class="n">satisfiesAllSpecs</span> <span class="o">&amp;=</span> <span class="n">productSpec</span><span class="o">.</span><span class="na">isSatisfiedBy</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">if</span><span class="o">(</span><span class="n">satisfiesAllSpecs</span><span class="o">)</span>
            	<span class="n">foundProducts</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">foundProducts</span><span class="o">;</span>
    <span class="o">}</span>
	<span class="o">}</span></code></pre></figure>

<ul>
  <li>코드를 보면 중복 코드가 다수 존재.</li>
  <li>Composite 패턴으로 중복을 제거할 수 있지만, 그렇지 않고도 중복은 제거 가능.</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">productRepository</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="n">List</span> <span class="n">selectBy</span><span class="o">(</span><span class="n">Spec</span> <span class="n">spec</span><span class="o">)</span> <span class="o">{</span>
    	<span class="n">Spec</span><span class="o">[]</span> <span class="n">specs</span> <span class="o">=</span> <span class="o">{</span> <span class="n">specs</span> <span class="o">};</span>
        <span class="k">return</span> <span class="n">selectBy</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">specs</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">List</span> <span class="n">selectBy</span><span class="o">(</span><span class="n">List</span> <span class="n">specs</span><span class="o">)</span> <span class="o">{</span>
			<span class="o">...</span>
		<span class="o">}</span>
	<span class="o">}</span></code></pre></figure>

<ul>
  <li>주어진 상황에 따라 Composite 패턴을 사용할지 말지 결정.</li>
  <li>현재 selectBy 메서드로는 AND, OR, NOT의 혼합 사용이 불가능.</li>
  <li>클라이언트 쪽에서는 조건의 종류에 관계없이 하나의 메서드만 사용하는 것이 좋음.</li>
  <li>그러므로 예제에서는 Composite 패턴으로 리팩터링 하는 것이 더 좋은 경우에 해당.</li>
</ul>

<p><em>Composite 패턴 적용</em></p>

<p>복수 객체 메서드로 전달되는 List 객체 보관하는 별도의 클래스 생성.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CompositeSpec</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="n">List</span> <span class="n">specs</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">CompositeSpec</span> <span class="o">{</span>
    	<span class="k">this</span><span class="o">.</span><span class="na">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">List</span> <span class="n">getSpecs</span><span class="o">()</span> <span class="o">{</span>
    	<span class="k">return</span> <span class="n">specs</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>selectBy 메서드 내에 List 객체 사용부분을 새로 만든 클래스로 대체.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductRepository</span><span class="o">{</span>
	<span class="kd">public</span> <span class="n">List</span> <span class="n">selectBy</span><span class="o">(</span><span class="n">List</span> <span class="n">specs</span><span class="o">)</span> <span class="o">{</span>
    	<span class="n">CompositeSpec</span> <span class="n">spec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CompositeSpec</span><span class="o">(</span><span class="n">specs</span><span class="o">);</span>
    	<span class="n">List</span> <span class="n">foundProducts</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
        <span class="n">Iterator</span> <span class="n">products</span> <span class="o">=</span> <span class="n">iterator</span><span class="o">();</span>
        <span class="k">while</span><span class="o">(</span><span class="n">products</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
        	<span class="n">Product</span> <span class="n">product</span> <span class="o">=</span> <span class="o">(</span><span class="n">Product</span><span class="o">)</span><span class="n">products</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="n">Iterator</span> <span class="n">specifications</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="na">getSpecs</span><span class="o">().</span><span class="na">iterator</span><span class="o">();</span>
            <span class="kt">boolean</span> <span class="n">satisfiesAllSpecs</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="k">while</span><span class="o">(</span><span class="n">specifications</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            	<span class="n">Spec</span> <span class="n">productSpec</span> <span class="o">=</span> <span class="o">((</span><span class="n">Spec</span><span class="o">)</span><span class="n">specifications</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
                <span class="n">satisfiesAllSpecs</span> <span class="o">&amp;=</span> <span class="n">productSpec</span><span class="o">.</span><span class="na">isSatisfiedBy</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">if</span><span class="o">(</span><span class="n">satisfiesAllSpecs</span><span class="o">)</span>
            	<span class="n">foundProducts</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">foundProducts</span><span class="o">;</span>
    <span class="o">}</span>
	<span class="o">}</span></code></pre></figure>

<p>정상 동작 테스트
selectBy 메서드 내의 Spec 객체 처리 부분 Extract Method 수행.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductRepository</span><span class="o">{</span>
	<span class="kd">public</span> <span class="n">List</span> <span class="n">selectBy</span><span class="o">(</span><span class="n">List</span> <span class="n">specs</span><span class="o">)</span> <span class="o">{</span>
    	<span class="n">CompositeSpec</span> <span class="n">spec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CompositeSpec</span><span class="o">(</span><span class="n">specs</span><span class="o">);</span>
    	<span class="n">List</span> <span class="n">foundProducts</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
        <span class="n">Iterator</span> <span class="n">products</span> <span class="o">=</span> <span class="n">iterator</span><span class="o">();</span>
        <span class="k">while</span><span class="o">(</span><span class="n">products</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
        	<span class="n">Product</span> <span class="n">product</span> <span class="o">=</span> <span class="o">(</span><span class="n">Product</span><span class="o">)</span><span class="n">products</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="k">if</span><span class="o">(</span><span class="n">isSatisfiedBy</span><span class="o">(</span><span class="n">spec</span><span class="o">,</span> <span class="n">product</span><span class="o">))</span>
            	<span class="n">foundProducts</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">foundProducts</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="n">isSatisfiedBy</span><span class="o">(</span><span class="n">CompositeSpec</span> <span class="n">spec</span><span class="o">,</span> <span class="n">Product</span> <span class="n">product</span><span class="o">)</span> <span class="o">{</span>
    	<span class="n">Iterator</span> <span class="n">specifications</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="na">getSpecs</span><span class="o">().</span><span class="na">iterator</span><span class="o">();</span>
        <span class="kt">boolean</span> <span class="n">satisfiesAllSpecs</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
        <span class="k">while</span><span class="o">(</span><span class="n">specifications</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">Spec</span> <span class="n">productSpec</span> <span class="o">=</span> <span class="o">((</span><span class="n">Spec</span><span class="o">)</span><span class="n">specifications</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
            <span class="n">satisfiesAllSpecs</span> <span class="o">&amp;=</span> <span class="n">productSpec</span><span class="o">.</span><span class="na">isSatisfiedBy</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">satisfiesAllSpecs</span><span class="o">;</span>
    <span class="o">}</span>
	<span class="o">}</span></code></pre></figure>

<p>정상 동작 테스트
isSatisfiedBy 메서드를 Move Method 리팩터링을 통해 CompositeSpec 내부로 이동.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductRepository</span><span class="o">{</span>
	<span class="kd">public</span> <span class="n">List</span> <span class="n">selectBy</span><span class="o">(</span><span class="n">List</span> <span class="n">specs</span><span class="o">)</span> <span class="o">{</span>
    	<span class="n">CompositeSpec</span> <span class="n">spec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CompositeSpec</span><span class="o">(</span><span class="n">specs</span><span class="o">);</span>
    	<span class="n">List</span> <span class="n">foundProducts</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
        <span class="n">Iterator</span> <span class="n">products</span> <span class="o">=</span> <span class="n">iterator</span><span class="o">();</span>
        <span class="k">while</span><span class="o">(</span><span class="n">products</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
        	<span class="n">Product</span> <span class="n">product</span> <span class="o">=</span> <span class="o">(</span><span class="n">Product</span><span class="o">)</span><span class="n">products</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="k">if</span><span class="o">(</span><span class="n">spec</span><span class="o">.</span><span class="na">isSatisfiedBy</span><span class="o">(</span><span class="n">spec</span><span class="o">,</span> <span class="n">product</span><span class="o">))</span>
            	<span class="n">foundProducts</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">foundProducts</span><span class="o">;</span>
    <span class="o">}</span>
	<span class="o">}</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CompositeSpec</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="n">isSatisfiedBy</span><span class="o">(</span><span class="n">Product</span> <span class="n">product</span><span class="o">)</span> <span class="o">{</span>
    	<span class="n">Iterator</span> <span class="n">specifications</span> <span class="o">=</span> <span class="n">getSpecs</span><span class="o">().</span><span class="na">iterator</span><span class="o">();</span>
        <span class="kt">boolean</span> <span class="n">satisfiesAllSpecs</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
        <span class="k">while</span><span class="o">(</span><span class="n">specifications</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">Spec</span> <span class="n">productSpec</span> <span class="o">=</span> <span class="o">((</span><span class="n">Spec</span><span class="o">)</span><span class="n">specifications</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
            <span class="n">satisfiesAllSpecs</span> <span class="o">&amp;=</span> <span class="n">productSpec</span><span class="o">.</span><span class="na">isSatisfiedBy</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">satisfiesAllSpecs</span><span class="o">;</span>
    <span class="o">}</span>
	<span class="o">}</span></code></pre></figure>

<ul>
  <li>복수 객체 메서드에서 CompositeSpec 객체를 생성한다는 점을 제외하면 이제 단수, 복수 객체 메서드의 구현이 동일해졌다.</li>
  <li>단수, 복수 객체 메서드 간 중복 코드 제거</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductRepository</span><span class="o">{</span>
	<span class="kd">public</span> <span class="n">List</span> <span class="n">selectBy</span><span class="o">(</span><span class="n">Spec</span> <span class="n">spec</span><span class="o">)...</span>

    <span class="kd">public</span> <span class="n">List</span> <span class="n">selectBy</span><span class="o">(</span><span class="n">List</span> <span class="n">specs</span><span class="o">)</span> <span class="o">{</span>
    	<span class="k">return</span> <span class="n">selectBy</span><span class="o">(</span><span class="k">new</span> <span class="n">CompositeSpec</span><span class="o">(</span><span class="n">specs</span><span class="o">));</span>
    <span class="o">}</span>
	<span class="o">}</span></code></pre></figure>

<p>CompositeSpec이 현재 Spec을 상속받고 있지 않기 때문에 위 코드에서는 에러가 발생
CompositeSpec 클래스를 Spec의 서브 클래스로 만든다.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CompositeSpec</span> <span class="kd">extends</span> <span class="n">Spec</span><span class="o">{</span>
	<span class="o">...</span>
<span class="o">}</span></code></pre></figure>

<p>정상 동작 테스트 후 selectBy(List specs) 메서드의 코드가 한 줄이므로 Inline Method 리팩터링을 적용해 인라인화.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductRepositoryTest</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="n">testFindByColorSizeAndBelowPrice</span><span class="o">()</span> <span class="o">{</span>
    	<span class="n">List</span> <span class="n">specs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
        <span class="n">specs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">ColorSpec</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">red</span><span class="o">));</span>
        <span class="n">specs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">SizeSpec</span><span class="o">(</span><span class="n">ProductSize</span><span class="o">.</span><span class="na">SMALL</span><span class="o">));</span>
        <span class="n">specs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">BelowPriceSpec</span><span class="o">(</span><span class="mf">10.00</span><span class="o">));</span>
        <span class="cm">/*List foundProducts = repository.selectBy(specs);*/</span>
        <span class="n">List</span> <span class="n">foundProducts</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="na">selectBy</span><span class="o">(</span><span class="k">new</span> <span class="n">CompositeSpec</span><span class="o">(</span><span class="n">specs</span><span class="o">));</span>
        <span class="o">...</span>
    <span class="o">}</span>
	<span class="o">}</span></code></pre></figure>

<ul>
  <li>Or 또는 Not 조건에 대한 구현에 대한 설명은 Replace Implicit Language with Interpreter 리팩터링으로 미룬다.</li>
  <li><em>타입 안정성 확보</em></li>
  <li>CompositeSpec 클래스 내부의 컬렉션 필드에 Encapsulate Collection 리팩터링 적용.</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CompositeSpec</span> <span class="kd">extends</span> <span class="n">Spec</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="n">List</span> <span class="n">specs</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="n">add</span><span class="o">(</span><span class="n">Spec</span> <span class="n">spec</span><span class="o">)</span> <span class="o">{</span>
    	<span class="n">specs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">spec</span><span class="o">);</span>
    <span class="o">}</span>
	<span class="o">}</span></code></pre></figure>

<p>specs 필드를 빈 List 객체로 초기화</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CompositeSpec</span> <span class="kd">extends</span> <span class="n">Spec</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="n">List</span> <span class="n">specs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
<span class="o">}</span></code></pre></figure>

<p>조건 추가 시 CompositeSpec의 add 메서드를 사용하도록 수정 (* Generics 사용으로 대체해도 될 듯)</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductRepositoryTest</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="n">testFindByColorSizeAndBelowPrice</span><span class="o">()</span> <span class="o">{</span>
    	<span class="cm">/*List specs = new ArrayList();*/</span>
        <span class="n">CompositeSpec</span> <span class="n">specs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CompositeSpec</span><span class="o">();</span>
        <span class="n">specs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">ColorSpec</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">red</span><span class="o">));</span>
        <span class="n">specs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">SizeSpec</span><span class="o">(</span><span class="n">ProductSize</span><span class="o">.</span><span class="na">SMALL</span><span class="o">));</span>
        <span class="n">specs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">BelowPriceSpec</span><span class="o">(</span><span class="mf">10.00</span><span class="o">));</span>
        <span class="cm">/*List foundProducts = repository.selectBy(new CompositeSpec(specs));*/</span>
        <span class="n">List</span> <span class="n">foundProducts</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="na">selectBy</span><span class="o">(</span><span class="n">specs</span><span class="o">);</span>

        <span class="o">...</span>
    <span class="o">}</span>
	<span class="o">}</span></code></pre></figure>

<p>여기까지의 과정을 마친 후에는 CompositeSpec의 생성자를 호출하는 코드가 없으므로 제거.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CompositeSpec</span> <span class="kd">extends</span> <span class="n">Spec</span> <span class="o">...</span>
	<span class="cm">/*public CompositeSpec(List specs) {
    	this.specs = specs;
    }*/</span></code></pre></figure>

<p>CompositeSpec의 getSpecs(…)가 수정이 불가능한 컬렉션을 리턴하도록 수정.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CompositeSpec</span> <span class="kd">extends</span> <span class="n">Spec</span> <span class="o">...</span>
	<span class="kd">private</span> <span class="n">List</span> <span class="n">specs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>

    <span class="kd">public</span> <span class="n">List</span> <span class="n">getSpecs</span><span class="o">()</span> <span class="o">{</span>
    	<span class="k">return</span> <span class="n">Collections</span><span class="o">.</span><span class="na">unmodifiableList</span><span class="o">(</span><span class="n">specs</span><span class="o">);</span>
    <span class="o">}</span></code></pre></figure>

<p>정상 동작 테스트 후 리팩터링 완료.</p>

<p><img src="https://github.com/YonghoChoi/YonghoChoi.github.io/tree/master/images/refactoring-to-patterns/Composite3.GIF" alt="" /></p>

    
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2016-01-04T00:40:00+09:00"><a href="http://yonghochoi.github.io//remind-2015/">January 04, 2016</a></time></span><span class="author vcard"><span class="fn"><a href="http://yonghochoi.github.io//about/" title="About YonghoChoi">YonghoChoi</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~4 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://yonghochoi.github.io//remind-2015/" rel="bookmark" title="2015년을 돌아보며.." itemprop="url">2015년을 돌아보며..</a></h1>
    
  </header>
  <div class="entry-content">
    
      <p>작년에는 놀고 먹은거에 대한 것만 돌아봤던거 같은데 올해는 느낀게 많으므로 개발에 관련된 부분들을 되돌아보고 싶었다. 서른이 된 해이기도 하고, 이직을 한 해이기도 하고, 또 다시 복직을 결심을 하게 된 해이기도 하고.. 참 혼란스러웠던 한 해 였다.</p>

<h2 id="section">2015년에 수행한 프로젝트</h2>

<h3 id="for-kakao">와리가리 삼총사 for kakao</h3>

<p>와리가리 삼총사는 로이게임즈에서 재직 중에 처음으로 런칭에 성공한 게임으로 2015년 2월에 오픈했다. 처음 접해본 파이썬으로 되어 있었고, 다른 언어에 비교적 진입 장벽이 낮다고 평가되는 언어이긴 했지만 짧은 시간내에 공부해서 런칭까지 경험해 보면서 다른 언어를 배우는 것에 대한 거부감이 상당히 많이 없어졌다. 오히려 다른 언어를 배워보는 것에 재미가 생겼고, 비록 조금 보다가 흐지부지 해지긴 했지만 여러가지를 시도해볼 수 있었다.</p>

<p>회사 생활에 있어서도 여러가지 추억이 있었는데 야근하며 노래 틀어놓고 다같이 흥얼대면서 코딩하기도 하고, 회의실 바닥에서 우드락 깔고 자는 날이 허다했고, 다른 협력 업체들이랑 싸우기도 하고 돌이켜보면 재밌는 추억이었던 것 같다.</p>

<h3 id="section-1">클럽 엠스타</h3>

<p>로이게임즈에서 넷마블 네오로 이직하면서 클럽 엠스타 서버팀으로 들어오게 되었는데 7~8년된 오래된 게임이었다. 유지보수 업무는 처음 맡아보는 것이었기 때문에 입사 당시에는 여러가지 해보고 싶은 것들이 있었다. 우선 로이게임즈에서 보고 배운 것처럼 빌드 배포의 자동화를 구축해 보고 싶었고, 이슈가 되고 있는 기술들 중에 적용해볼 수 있는 것들이 있으면 도입을 해보고 싶었다.</p>

<p>가장 먼저 했던 일은 컨텐츠 구현과 병행해서 기획팀에서 쉽게 작업을 할 수 있도록 툴을 제공하는 것이었다. 그리고 현재 서버팀에서 서버를 배포하는 일에 스크립트를 사용하고 있었는데 이를 툴로 해결 할 수 있도록 하는 것이 처음 지시받은 작업이었다. 이를 위한 툴이 c++로 이미 개발이 되어 있던 것이 있었는데 유지보수의 어려움이 있어서 이를 참고해서 C#으로 개선했다. 하지만 다른 작업들로 인해 마무리가 흐지부지해져서 퇴사할 때 어느정도 완성해서 배포했다.</p>

<p>이 후에는 Jenkins를 도입해서 빌드, 배포를 자동화 시켰는데 혼자 작업하기가 버거워서 테스트까지는 추가하지 못했다. Jenkins를 해보면서 여러가지 시행 착오를 거쳤는데 내가 작업하기 제일 편한 방식으로 제 멋대로 해서 잘한 건지는 모르겠다. (빌드는 devenv로 수행하고, 파일 복사나 배포와 같은 작업은 C#으로 프로그램을 구현한 후에 Jenkins에서 수행하도록) 아무튼 빌드가 되는 모습을 보니 뿌듯함을 느끼기도 했다. (처음 해보는 거라..)</p>

<p>하지만 반년간 이 곳에 있으면서 느낀 것은 내가 하고 싶다고 해서 되는 것은 아니라는 것이었다. 회사 규모가 크기도 하고 현재 라이브 서비스를 진행 중이니 그럴만도 하다. 어쩔 수 없이 다른 것들을 시도도 못해보고 이 틀안에서만 작업을 해야한다고 생각하니까 visual studio를 켜고 코드를 볼 때마다 받는 스트레스가 생각보다 컸다.</p>

<p>결과적으로는 지금의 나에게는 큰회사보다는 작은 회사에서 서로 신뢰할 수 있는 팀에서 여러가지 경험을 쌓는 것이 더 득일거라는 판단에 이직을 결심하게 되었다.</p>

<h2 id="section-2">2015년에 시도해 본 것들</h2>

<ol>
  <li>영어공부
    <ul>
      <li>출근 시간에 Gramer in use Chapter 1 씩 공부</li>
      <li>걷는 시간에 Gramer in use 강의 청취</li>
      <li>출근 후 30분 여유 시간에 kakao english</li>
      <li>퇴근 후 English for developers 책 하나씩 독해 (중간에 포기)</li>
    </ul>
  </li>
  <li>개발 관련 책 읽기
    <ul>
      <li>비주얼 씽킹</li>
      <li>몰입! 자바스크립트</li>
      <li>읽기 좋은 코드가 좋은 코드다.</li>
      <li>가장 빨리 만나는 Go 언어 (완독 실패)</li>
      <li>스칼라로 배우는 함수형 프로그래밍 (완독 실패)</li>
      <li>실용주의 프로그래머 (완독 실패)</li>
      <li>누워서 읽는 알고리즘 (완독 실패)</li>
      <li>자바 성능 튜닝 이야기 (읽는 중)</li>
      <li>JSP 2.3 웹 프로그래밍 (읽는 중)</li>
    </ul>
  </li>
  <li>개발 관련 강의 듣기
    <ul>
      <li>나는 프로그래머다 청취</li>
      <li>케빈 tv 시청</li>
      <li>동영상 강의 시청 (생활코딩, 자바)</li>
    </ul>
  </li>
  <li>컨퍼런스 / 세미나 다니기
    <ul>
      <li>Deview 2015</li>
      <li>Gophercon korea 2015</li>
      <li>Sk Tech Planet 2015</li>
      <li>나는 프로그래머다 Con 2015</li>
    </ul>
  </li>
  <li>웹 개발 배우기 (오프라인 강의)
    <ul>
      <li>CSS</li>
      <li>Javascript</li>
      <li>JSP</li>
    </ul>
  </li>
  <li>홈페이지 만들어보기
    <ul>
      <li>AWS에 서버 올리기</li>
      <li>Github에 블로그 만들기 (Jekyll 사용)</li>
    </ul>
  </li>
  <li>스터디 모임 참여하기
    <ul>
      <li>영어 스피킹 오프라인 스터디 모임</li>
      <li>알고리즘 온라인 스터디 모임</li>
    </ul>
  </li>
  <li>슬라이드 쉐어 공유해보기
    <ul>
      <li>Jenkins 관련 슬라이드 공유</li>
    </ul>
  </li>
</ol>

<h2 id="section-3">2016년에 시도해 볼 것들</h2>

<ol>
  <li>영어 공부
    <ul>
      <li>2015년에 해 온대로 꾸준히</li>
      <li>미드 보기</li>
    </ul>
  </li>
  <li>개발 관련 책 10권 이상 읽기
    <ul>
      <li>완독 실패한 책 완독하기</li>
      <li>자바8 인 액션</li>
      <li>자바 네트워크 소녀 Netty</li>
      <li>시작하세요! 엘라스틱 서치</li>
      <li>패턴을 활용한 리펙터링</li>
      <li>토비의 스프링</li>
      <li>차세대 웹 표준 기술 HTML5</li>
      <li>가장 빨리 만나는 Docker</li>
      <li>이펙티브 자바</li>
    </ul>
  </li>
  <li>블로그 포스팅 100개 이상 하기</li>
  <li>사소한 거라도 Github에 공유해보기</li>
  <li>오픈 소스 사용해보기
    <ul>
      <li>ELK Stack</li>
      <li>Jenkins</li>
      <li>React</li>
      <li>Bootstrap</li>
      <li>AngularJS</li>
      <li>Node.js</li>
      <li>등등</li>
    </ul>
  </li>
  <li>자바 공부하기 (장기간 디테일하게)</li>
  <li>솔직해지자
    <ul>
      <li>업무 중 실수에 대한 부분 인정</li>
      <li>모르는 것 인정</li>
      <li>다른 사람이 잘한 것 인정</li>
    </ul>
  </li>
  <li>전문가가 되자
    <ul>
      <li>내가 하는 일에 대한 것 만큼은 전문가가 되도록 노력하자</li>
    </ul>
  </li>
</ol>

<h2 id="section-4">돌아보며…</h2>

<p>2015년은 그 동안 내가 프로그래머로 지내오면서 가지고 있던 마인드와 삶의 패턴이 바뀔 정도로 나에게 큰 영향을 준 해였다. 그렇게 된 이유는 이직 때문이었는데 이직을 한 직장에서 배운 것이 아니라 이 전 직장에서 알게 모르게 많은 것을 배우고 있었구나라는 생각 때문이었다.</p>

<p>이직을 하고 나니 이곳에는 어떠한 커뮤니케이션이나 개발자끼리의 발전을 위한 노력이 전혀 없었고, 이대로는 도태되겠다라는 생각 때문에 컨퍼런스도 찾아다니고 온/오프라인 커뮤니티를 찾아다니며 자기계발에 노력을 했었다.</p>

<p>그렇게 혼자 떠돌아다니며 많은 지식들을 얻을 수 있었지만 정리는 되지 않았다. 오히려 너무 많은 정보들과 해야할 것들 때문에 혼란이 왔었고, 이것 저것 손만 대보다가 도중에 흐지부지 되는 상황이 반복되었다. 그래서 남들이 대화하는 내용들을 들으면 알아들을 수는 있어도 깊게 들어가면 전혀 대답할 수 없는 지경이 되다보니 이래선 이도저도 안되겠다는 생각이 들었다.</p>

<p>이직 후 초기에는 회사 내에서도 혼자서 무언가 구축해보고 이것저것해보며 뿌듯함도 느끼고 컨퍼런스를 다니며 배우는 것도 많다고 생각했었지만 4개월 정도 지나자 팀에서 팀원간에 교류나 배울 것이 전혀 없는 상황에서 혼자 고군분투 해봐야 효율도 많이 떨어지고 방향도 제대로 잡지 못해서 스트레스만 받고 있었다. 그 때부터 누군가 방향을 잡아주고 함께 고민해볼 수 있는 팀이 있었으면 좋겠다고 생각했는데 이 전팀이 바로 그랬었다.</p>

<p>그래서 결국에는 이 전 팀에 복직을 부탁드렸고 다행스럽게도 받아주셔서 2016년부터 다시 함께 일하게 되었다. 비교해보면 이직하고 나서 공부도 더 열심히 하고 운동도 더 열심히 했었다. 하지 않으면 뒤쳐진다는 생각과 나를 도와줄 사람이 없다는 생각 때문에 절실함이 생겼었던 것 같다. 그래서 이런 상황에서 운동도 하지 않으면 스트레스를 너무 받아서 운동도 거의 빠지지 않고 꾸준히 했었다.</p>

<p>써놓고 보니 문제 투성이 팀에서 나혼자 독립군처럼 싸우고 있는 듯하게 되었는데, 팀은 잘 돌아갔고 회사에서도 수익을 가장 많이 내는 팀이었으므로 팀에 문제는 딱히 없었다. 각자 묵묵히 자신의 업무에 대해 책임지고 수행해내는 식으로 업무를 진행하고 있었고 나는 열심히 물어보고 거기서 배우는 것을 좋아하기 때문에 성향이 맞지 않았다고 생각한다. 그래서 나랑 잘 맞는 팀으로 돌아가려고 하는 것이고..</p>

<p>아무튼 이제 내일부터 이 전 회사에 복직해서 업무를 시작하는데 팀의 소중함을 깨달은 지금으로서는 앞으로의 회사 생활이 굉장히 기대된다. 여태까지보다 업무량은 훨씬 많아지겠지만 재미있게 일 할 수 있을 것 같다. 회사의 불만은 어딜 가나 생기는 것 같고 이번에도 마찬가지겠지만 2016년에는 거기에 지지말고 하고 싶은 일을 하면서 많은 걸 배울 수 있었으면 좋겠다.</p>

    
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-12-29T23:50:00+09:00"><a href="http://yonghochoi.github.io//jenkins-setting/">December 29, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="http://yonghochoi.github.io//about/" title="About YonghoChoi">YonghoChoi</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~3 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://yonghochoi.github.io//jenkins-setting/" rel="bookmark" title="젠킨스 구축 하기 (Windows)" itemprop="url">젠킨스 구축 하기 (Windows)</a></h1>
    
  </header>
  <div class="entry-content">
    
      <h2 id="setup">Setup</h2>

<ol>
  <li>Jenkins 홈페이지에서 Window 버젼 다운로드</li>
  <li>설치가 완료되면 자동으로 localhost:8080 으로 접속됨</li>
  <li>이 때 8080 port가 사용 중이면 404에러 발생
    <ul>
      <li>Jenkins가 설치된 경로로 이동(C:\Program Files (x86)\Jenkins)해서 Jenkins.xml 파일 수정 (port를 8080이 아닌 다른 값으로 설정)</li>
    </ul>
  </li>
  <li>웹 페이지가 출력되면 기본 설치는 완료.</li>
</ol>

<h2 id="git-">Git 연동</h2>

<ol>
  <li>Jenkins 관리 -&gt; 플러그인 관리 -&gt; Git 관련 플러그인 설치 (Github을 이용하면 Github 관련 Plugin을, Bitbucket을 이용하면 Bitbucket 관련 Plugin을 설치)
    <ul>
      <li>Git Plugin</li>
      <li>Github Plugin</li>
      <li>Bitbucket Oauth Plugin</li>
      <li>Bitbucket Plugin</li>
    </ul>
  </li>
  <li>새로운 Item 선택
    <ul>
      <li>Free-stype로 생성</li>
    </ul>
  </li>
  <li>Git plugin을 사용하려면 몇가지 환경 설정이 필요하다.
    <ul>
      <li>참고 : http://computercamp-cdwilson-us.tumblr.com/post/48589650930/jenkins-git-clone-via-ssh-on-windows-7-x64</li>
      <li>Jenkins 관리 -&gt; 시스템 구성 -&gt; Git -&gt; Path to Git executable</li>
      <li>git.exe 연결이 제대로 되어 있지 않아서 빨간 글씨로 오류가 나 있을 것이다.</li>
      <li>Git이 설치된 경로(C:\Program Files\Git) 에서 bin/git.exe 경로를 입력한다.</li>
      <li>C:\Program Files\Git\bin\git.exe</li>
      <li>적용 버튼 클릭</li>
    </ul>
  </li>
  <li>초기의 Jenkins를 구동시키는 것은 Local System account이지 user 계정이 아니다. Local System account는 SSH key 가지고 있지 않거나 나 known_hosts이 설정되어 있지 않다. 그러므로 git clone을 수행하면 clone에 실패할 것이다.
    <ul>
      <li>이를 해결하기 위해서는 ssh key를 gen 해서 git에 add 해줘야 한다.
        <ul>
          <li>http://knight76.tistory.com/entry/git-Permission-denied-%EB%AC%B8%EC%A0%9C-%ED%95%B4%EA%B2%B0</li>
          <li>https://help.github.com/articles/error-permission-denied-publickey/</li>
          <li>http://uiandwe.tistory.com/992</li>
          <li>https://backlogtool.com/git-guide/kr/reference/trouble-shooting.html</li>
        </ul>
      </li>
      <li>내 경우에는 설정에 Git 계정과 비밀번호를 등록했더니 해결되었다.
        <ul>
          <li>Jenkins 관리 -&gt; 시스템 설정 -&gt; Git Plugin에 username과 email 입력</li>
          <li>Jenkins 홈 -&gt; Git 프로젝트 item을 선택 -&gt; 구성 -&gt; 소스코드 관리 -&gt; Git -&gt; Credentials에 계정 Add</li>
        </ul>
      </li>
    </ul>
  </li>
</ol>

<h2 id="msbuild-">MSBuild 설정</h2>

<ol>
  <li>Visual Studio 프로젝트를 빌드하기 위해 MSbuild를 사용</li>
  <li>Jenkins 관리 -&gt; 플러그인 관리 -&gt; MSBuild Plugin 설치 -&gt; Jenkins 재시작</li>
  <li>Jenkins 관리 -&gt; 시스템 설정 -&gt; MSBuild -&gt; Add MSBuild
    <ul>
      <li>Name : .Net Framework 4.0 (이름은 알아서 지정)</li>
      <li>Path to MSBuild : C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe (환경에 맞는 MSBuild를 선택)</li>
    </ul>
  </li>
  <li>Jenkins 홈 -&gt; Git 프로젝트 item을 선택 -&gt; 구성 -&gt; Build -&gt; Add build step -&gt; Build a visual studio project or solution using MSBuild 선택
    <ul>
      <li>MSBuild Version : 3번에서 지정한 Name 선택</li>
      <li>MSBuild Build File : 빌드할 솔루션의 경로지정</li>
    </ul>
  </li>
  <li>Jenkins 홈 -&gt; 빌드 시작</li>
  <li>Console Output 을 확인하면 빌드 진행 상황을 체크 할 수 있다.</li>
  <li>빌드시 프로젝트 설정대로 빌드를 하지 않아 오류가 발생했다.
    <ul>
      <li>MSBuild 수행할때 옵션이 필요
        <ul>
          <li>http://acidpop.tistory.com/118</li>
        </ul>
      </li>
      <li>아직 정확한 문제파악이 되지 않아 알아보는 중
        <ul>
          <li>msbuild 관련 슬라이드쉐어 : http://www.slideshare.net/kaistizen/ss-10084687</li>
          <li>빌드 순서에 대한 문제 해결: http://resisa.tistory.com/104</li>
        </ul>
      </li>
      <li>MSBuild 개념 잡기
        <ul>
          <li>http://ccambo.blogspot.kr/2014/02/msbuild-1.html</li>
          <li>http://megustaria.tistory.com/3</li>
        </ul>
      </li>
      <li>알게된 정보
        <ul>
          <li>msbuild는 c++ 빌드하기가 까다롭다?
            <ul>
              <li>vcbuild</li>
              <li>devenv 고려</li>
            </ul>
          </li>
          <li>visual studio 2005 프로젝트를 msbuild로 빌드하려면 .Net framework 2.0 버젼으로 해본다</li>
          <li>현재 프로젝트의 .net framework 버젼을 확인한 후 해당 버젼으로 시도</li>
          <li>vs2005에서 msbuild 사용하기 : http://stackoverflow.com/questions/832602/msbuild-with-visual-studio-2005</li>
          <li>DependsOnTargets 속성으로 빌드 순서를 정할 수 있다</li>
        </ul>
      </li>
    </ul>
  </li>
</ol>

<h2 id="devenv-">Devenv 사용</h2>

<ul>
  <li>
    <p>MSBuild를 사용해서 MStar 프로젝트를 빌드해보니 Dependency 때문에 빌드가 제대로 되지 않았다. (MSBuild는 프로젝트간 의존성을 무시하고 순서대로 빌드) 그래서 devenv를 사용하는 방법으로 알아보았다.</p>
  </li>
  <li>
    <p>빌드 커맨드 :  devenv.exe [솔루션 경로] [option]</p>
  </li>
  <li>Example
    <ul>
      <li>“C:\Program Files (x86)\Microsoft Visual Studio 8\Common7\IDE\devenv.com” /INCREMENTAL:NO /useenv “C:\work\jenkins_test\jenkins_test.sln”  /Build “Debug|Win32” /out “C:\buildlog.txt”
(/Build를 수행할 때 Debug 환경에 Win32 플랫폼으로 빌드하고 출력되는 로그는 C:\buildlog.txt에 저장)</li>
      <li>devenv.exe와 devenv.com으로 명령 수행이 가능한데 devenv.exe는 콘솔 출력이 없고 devenv.com은 콘솔에 출력을 해준다.</li>
      <li>/out 옵션을 사용하면 인자로 전달되는 경로에 로그가 기록된다.</li>
    </ul>
  </li>
  <li>참고
    <ul>
      <li>https://msdn.microsoft.com/ko-kr/library/b20w810z.aspx</li>
    </ul>
  </li>
</ul>

<h2 id="jenkins-batch-command---">Jenkins에서 batch command 관리자 권한으로 실행</h2>

<ul>
  <li>devenv를 이용해서 빌드 시 관리자 권한으로 수행해야 정상적으로 빌드가 되는데 이를 커맨드 상에서 지정하는 방법이 기본적으로는 없고, Jenkins 서비스 자체를 관리자 권한으로 시작하는 방법을 사용해야 한다.
    <ul>
      <li>서비스 -&gt; Jenkins 에서 속성으로 진입 -&gt; 로그온 -&gt; 계정 지정 -&gt; 관리자 지정</li>
      <li>Jenkins 서비스 재시작</li>
    </ul>
  </li>
  <li>참고
    <ul>
      <li>http://stackoverflow.com/questions/27413261/run-batch-file-as-administrator-on-jenkins</li>
    </ul>
  </li>
</ul>

<h2 id="section">빌드 시 매개변수 설정</h2>

<ol>
  <li>Jenkins Item의 구성에 들어가서 “이 빌드는 매개변수가 있습니다.”에 체크한다.</li>
  <li>상황에 맞는 매개변수를 선택한 후 값을 지정한다.</li>
  <li>build 명령에서 매개변수 이름 앞뒤에 %를 붙이면 빌드 시 해당 매개변수의 값으로 치환된다.
    <ul>
      <li>ex) 매개변수명 : Command -&gt; %Command%</li>
    </ul>
  </li>
</ol>

<h2 id="section-1">이슈 해결</h2>

<ol>
  <li>Windows Batch command를 이용해서 프로그램을 실행 시킬 때 코드 내에 “Environment.CurrentDirectory”를 이용하거나 “Directory.GetCurrentDirectory()”를 사용해서 경로를 가지고 오는 경우 프로젝트의 작업 디렉토리가 아닌 파일을 실행시킨 위치를 가져오므로 잘못된 위치를 가리킬 수 있다. 프로젝트의 작업 디렉토리를 가져오기 위해서는 “AppDomain.CurrentDomain.BaseDirectory”를 사용한다.</li>
  <li>젠킨스를 이용해서 다른 피씨에 배포를 하는 경우 경로를 찾지 못하는 문제가 발생했다. 로컬에서는 정상 동작하는데 외부 피씨로 배포하는 경우에만 자꾸 경로를 찾지 못해서 한참을 헤매던 중 젠킨스로 실행 될 때 실행하는 사용자 계정을 찍어보니 AUTHORITY\SYSTEM 이었다. 이는 젠킨스 서비스의 설정이 로컬 시스템 계정으로 되어있기 때문이었는데 원격 피씨의 공유 폴더에 이 계정에 대한 권한이 없어서 였다. 그래서 공유폴더에 권한을 가지고 있는 계정으로 지정해서 서비스를 재시작하니 해결되었다.</li>
</ol>

    
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-12-26T00:32:00+09:00"><a href="http://yonghochoi.github.io//add-social-plugin/">December 26, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="http://yonghochoi.github.io//about/" title="About YonghoChoi">YonghoChoi</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://yonghochoi.github.io//add-social-plugin/" rel="bookmark" title="웹 페이지에 소셜 플러그인 추가하기" itemprop="url">웹 페이지에 소셜 플러그인 추가하기</a></h1>
    
  </header>
  <div class="entry-content">
    
      <h2 id="section">웹페이지에 소셜 공유 링크 추가하기</h2>

<p><a href="https://developers.google.com/+/web/share/">구글</a>이나 <a href="https://about.twitter.com/ko/resources/buttons">트위터</a>, <a href="https://developers.facebook.com/docs/plugins?locale=ko_KR#like-share-send">페이스북</a>에서는 트윗하기, 좋아요 버튼에 대한 API를 제공한다. 코드까지 제공해주기 때문에 API 제공 페이지에서 복사해서 간단하게 사용할 수가 있다.</p>

<p>구글과 페이스북은 현재 페이지의 URL을 알아서 링크해주기 때문에 문제가 되지 않았는데 페이스북 API의 경우에는 현재 페이지의 URL을 직접 넣어주어야 했다. 그래서 이 부분을 동적으로 생성해주어야 하는데 Jekyll을 이용해서 간단하게 해결할 수 있었다.</p>

<h2 id="jekyll---url-">Jekyll로 현재 페이지 URL 만들기</h2>

<p>Jekyll 홈페이지를 참고해서 현재 페이지의 URL을 얻어 올 수 있는 Variable이 page와 site라는 것을 알 수 있었다. page는 단어 그대로 현재 페이지에 대한 정보를 담고 있고 site에는 이 홈페이지에 대한 정보가 담겨져 있다. 그래서 page를 통해 URI를 얻어 올 수 있고, site를 통해 이 사이트의 주소를 알수가 있어서 조합하면 현재 페이지의 주소를 알아낼 수가 있다.</p>
<pre>
 href="http://yonghochoi.github.io//add-social-plugin/"
 </pre>


    
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->



<div class="pagination">
  <ul class="inline-list">
    
    

    
    
      <li><strong class="current-page">1</strong></li>
    

    
    

    
    
    

    

    
    

    
      <li><a href="http://yonghochoi.github.io//page2/">2</a></li>
    

    
    
      <li><a href="http://yonghochoi.github.io//page2/" class="btn">Next</a></li>
    
  </ul>
</div>


</div><!-- /#main -->

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript">window.jQuery || document.write('<script type="text/javascript" src="http://yonghochoi.github.io//assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script type="text/javascript" src="http://yonghochoi.github.io//assets/js/scripts.min.js"></script>
<script type="text/javascript" async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
<script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>







<script type="text/javascript">
    sharing();
</script>



<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2016 YonghoChoi. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://github.com/aron-bordin/neo-hpstr-jekyll-theme" rel="nofollow">Neo-HPSTR Theme</a>.</span>

  </footer>
</div><!-- /.footer-wrapper -->

</body>
</html>
